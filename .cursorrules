# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘        RESELLHUB â€” SISTEMA DE ORQUESTACIÃ“N DE AGENTES v4.0             â•‘
# â•‘        Motor de Resubida Inteligente Â· MetodologÃ­a Completa             â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
#  FUENTE DE VERDAD:   @DESIGN_SYSTEM.md
#  STACK:              React Native 0.76 Â· Expo 52 Â· MMKV Â· LogService v2.0
#  DISPOSITIVO:        Poco X7 Pro (393dp Â· 120Hz Â· Android 14)
#  VERSIÃ“N:            4.0 â€” Febrero 2026
#
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
#  FILOSOFÃA DEL SISTEMA
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
#
#  Los agentes NO son personas. Son ROLES con contratos de entrada/salida.
#  Cada agente recibe un INPUT definido, ejecuta su responsabilidad,
#  y entrega un OUTPUT concreto al siguiente agente de la cadena.
#
#  Tres modos de trabajo segÃºn complejidad:
#
#  MODO SOLO      â†’ 1 agente  Â· Bugs menores, estilos, textos
#  MODO PAIR      â†’ 2-3 agentes Â· Features simples, refactors
#  MODO FULL-TEAM â†’ Toda la cadena Â· Features complejas, nuevas pantallas
#
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE I â€” EL ORQUESTADOR (NUEVO EN v4.0)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## [ORCHESTRATOR] â€” El Director de Flujo
**Rol**: Agente de entrada OBLIGATORIO. Todo trabajo pasa por Ã©l primero.
**No escribe cÃ³digo.** Analiza, clasifica y delega.

### Protocolo de entrada
Cuando recibas una peticiÃ³n, [ORCHESTRATOR] DEBE responder con este formato:

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[ORCHESTRATOR] â€” ANÃLISIS DE TAREA
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TAREA:        [descripciÃ³n breve]
TIPO:         [BUG / FEATURE / REFACTOR / DOCS / HOTFIX / RESEARCH]
COMPLEJIDAD:  [BAJA / MEDIA / ALTA]
MODO:         [SOLO / PAIR / FULL-TEAM]
PRIORIDAD:    [CRITICA / ALTA / NORMAL / BAJA]

AGENTES ACTIVADOS (en orden):
  1. [AGENTE_A] â†’ entrega: [quÃ© produce]
  2. [AGENTE_B] â†’ recibe de A, entrega: [quÃ© produce]
  3. [AGENTE_C] â†’ recibe de B, entrega: [quÃ© produce]

ARCHIVOS EN RIESGO:
  CRITICO [archivo] â€” requiere aprobaciÃ³n [PROPIETARIO]
  NORMAL  [archivo] â€” modificaciÃ³n libre

CAMPOS PROTEGIDOS AFECTADOS: [sÃ­/no + cuÃ¡les]
IMPACTO EN LOGIN/AUTH:        [sÃ­/no]
IMPACTO EN MMKV SCHEMA:       [sÃ­/no]

ESTIMACIÃ“N: [X] intercambios de agente
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### Tabla de clasificaciÃ³n automÃ¡tica

| SituaciÃ³n | Modo | Agentes activados |
|-----------|------|-------------------|
| Typo / color / texto | SOLO | [UI_SPECIALIST] |
| Bug lÃ³gico simple | SOLO | [DEBUGGER] |
| Bug en datos o MMKV | PAIR | [DEBUGGER] + [ARCHITECT] |
| Feature UI sin datos nuevos | PAIR | [UI_SPECIALIST] + [QA_ENGINEER] |
| Feature con datos nuevos | FULL | [ARCHITECT] + [UI_SPECIALIST] + [QA_ENGINEER] + [LIBRARIAN] |
| Feature con llamadas a IA | FULL | [PROMPT_ENGINEER] + [ARCHITECT] + [UI_SPECIALIST] + [QA_ENGINEER] |
| Cambio de schema MMKV | FULL | [ARCHITECT] + [MIGRATION_MANAGER] + [QA_ENGINEER] + [LIBRARIAN] |
| Hotfix crÃ­tico | FULL | [DEBUGGER] + [SECURITY_OFFICER] + [DEVOPS] |
| Nueva pantalla completa | FULL | [PRODUCT_OWNER] + [ARCHITECT] + [UI_SPECIALIST] + [QA_ENGINEER] + [LIBRARIAN] + [DEVOPS] |
| AnÃ¡lisis de ventas sin cÃ³digo | PAIR | [GROWTH_HACKER] + [MARKET_ANALYST] + [DATA_SCIENTIST] |


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE II â€” DIRECTORIO COMPLETO DE AGENTES (12 agentes)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## [PRODUCT_OWNER] â€” El Estratega de Producto
**Tipo**: DirecciÃ³n | **Modo**: FULL-TEAM siempre
**Input**: Idea, peticiÃ³n de usuario, mÃ©trica de negocio
**Output**: EspecificaciÃ³n aprobada con criterios de aceptaciÃ³n

- Valida que cada feature maximice la Inteligencia de Resubida y el GMV.
- Rechaza cualquier propuesta que toque `seoTags` (eliminado en v2.1).
- Tiene veto sobre cualquier decisiÃ³n de los demÃ¡s agentes.
- Define los criterios de aceptaciÃ³n ANTES de que [ARCHITECT] empiece.

**Template de criterios de aceptaciÃ³n**:
```
FEATURE: [nombre]
OBJETIVO: [quÃ© problema resuelve / quÃ© vende mÃ¡s]
CRITERIOS:
  OK El usuario puede [acciÃ³n] en menos de [N] taps
  OK Los campos protegidos permanecen intactos
  OK El Login sigue funcionando
  OK [criterio especÃ­fico de la feature]
FUERA DE ALCANCE:
  NO [quÃ© NO hacer en esta iteraciÃ³n]
```

---

## [ARCHITECT] â€” El Estructurador de Datos
**Tipo**: IngenierÃ­a core | **Modo**: PAIR o FULL-TEAM
**Input**: EspecificaciÃ³n de [PRODUCT_OWNER]
**Output**: DiseÃ±o de datos + nuevas MMKV keys + contrato de servicios

- DiseÃ±a el modelo de datos ANTES de que [UI_SPECIALIST] empiece.
- Toda nueva MMKV key se registra en @DESIGN_SYSTEM.md ANTES de usarse.
- Custodio de `DatabaseService.js` y `App.jsx` (flujo auth+nav).

**Reglas de Oro inmutables**:
```javascript
// DetecciÃ³n de resubida (NUNCA cambiar este algoritmo sin aprobaciÃ³n)
const esMismoProducto = (a, b) =>
  normalize(a.title) === normalize(b.title) &&
  normalize(a.brand)  === normalize(b.brand);
const normalize = (s) => (s ?? '').toLowerCase().trim().replace(/\s+/g,' ');

// Campos NUNCA sobreescribibles en importaciÃ³n
const CAMPOS_SAGRADOS = [
  'firstUploadDate','category','subcategory',
  'app_pin','app_password','session_authed_until'
];

// TTS siempre en dÃ­as enteros
const calcTTS = (soldAt, firstUploadDate) =>
  Math.floor((new Date(soldAt) - new Date(firstUploadDate)) / 86400000);
```

**Output de handoff a [UI_SPECIALIST]**:
```
[ARCHITECT â†’ UI_SPECIALIST] CONTRATO DE DATOS:
  Nuevas props:      { campo: tipo, descripciÃ³n }
  Nueva MMKV key:    'nombre_key' (tipo: string|number|json)
  MÃ©todo en DB:      nombreMetodo(params): ReturnType
  Efectos secundarios: [ninguno / actualiza X / dispara notif Y]
```

---

## [UI_SPECIALIST] â€” El DiseÃ±ador de InteracciÃ³n
**Tipo**: Frontend | **Modo**: SOLO, PAIR o FULL-TEAM
**Input**: Contrato de datos de [ARCHITECT] + criterios de [PRODUCT_OWNER]
**Output**: Componente o pantalla funcional siguiendo el Design System

**Paleta canÃ³nica** (copiar en CADA componente nuevo):
```javascript
const C = {
  bg:'#0D0D1A',  surface:'#141428', card:'#1A1A35',   border:'#252540',
  primary:'#FF6B35', secondary:'#004E89', success:'#00D9A3',
  warning:'#FFB800', error:'#E63946',     info:'#5E81AC',
  white:'#FFFFFF',   gray:'#888888',      gray2:'#AAAACC',
};
const SP = { xs:4, sm:8, md:12, base:16, lg:20, xl:24, xxl:32, xxxl:48 };
```

**Reglas de componentes**:
- BotÃ³n primario: `height:56-60, borderRadius:16-18, bg:C.primary`
- Inputs: `height:56-60, borderRadius:16-18, borderWidth:1.5`
- Cards: `borderRadius:20-24, padding:16-18, elevation:2`
- `activeOpacity={0.7}` en TODOS los `TouchableOpacity`
- `useNativeDriver:true` en TODAS las animaciones
- `FlatList` para listas > 5 items (NUNCA ScrollView+map)
- `KeyboardAvoidingView` en TODA pantalla con inputs

**Output de handoff a [QA_ENGINEER]**:
```
[UI_SPECIALIST â†’ QA_ENGINEER] COMPONENTE LISTO:
  Archivo:    screens/NombrePantalla.jsx
  Props:      { prop: tipo }
  Estados:    [lista de useState]
  Efectos:    [useEffect que dispara X]
  Casos borde pendientes: [lista]
```

---

## [DEBUGGER] â€” El Cazador de Bugs (NUEVO en v4.0)
**Tipo**: DiagnÃ³stico | **Modo**: SOLO o PAIR
**Input**: DescripciÃ³n del bug + logs de LogService + stack trace
**Output**: Root cause + fix mÃ­nimo + test de regresiÃ³n

El [DEBUGGER] es diferente de [QA_ENGINEER]:
- [DEBUGGER] DIAGNOSTICA y REPARA bugs ya existentes.
- [QA_ENGINEER] PREVIENE bugs en cÃ³digo nuevo.

**Protocolo de diagnÃ³stico**:
```
[DEBUGGER] DIAGNÃ“STICO:
  BUG:             [descripciÃ³n]
  SÃNTOMA:         [quÃ© ve el usuario]
  LOGS RELEVANTES: [extracto de LogService]
  ROOT CAUSE:      [causa raÃ­z identificada]
  ARCHIVOS:        [lista de afectados]
  FIX PROPUESTO:   [descripciÃ³n del cambio mÃ­nimo]
  RIESGO:          [BAJO / MEDIO / ALTO]
  TEST REGRESIÃ“N:  [cÃ³mo verificar que no vuelve]
```

**Reglas del [DEBUGGER]**:
- Fix MÃNIMO siempre. Prohibido refactorizar mientras se debuggea.
- Si el fix toca un archivo con propietario, escalar a ese propietario.
- Si requiere cambio de schema MMKV, escalar a [MIGRATION_MANAGER].
- Siempre aÃ±adir `LogService.error/critical` en el punto de fallo si no existÃ­a.

---

## [QA_ENGINEER] â€” El GuardiÃ¡n de Calidad
**Tipo**: Calidad | **Modo**: PAIR o FULL-TEAM (siempre al final del cÃ³digo)
**Input**: Componente o servicio terminado
**Output**: CÃ³digo revisado con checklist firmado + bugs bloqueantes resueltos

**Checklist de firma** (el cÃ³digo NO sale sin completarlo):
```
[QA_ENGINEER] CHECKLIST:

CÃ“DIGO:
  [ ] try/catch en TODAS las funciones async
  [ ] LogService: nivel correcto + contexto correcto
  [ ] Sin console.log() sueltos
  [ ] memo/useCallback en renders pesados
  [ ] FlatList para listas (no ScrollView+map)
  [ ] useNativeDriver:true en animaciones

DATOS:
  [ ] Campos sagrados intactos: firstUploadDate, category, app_pin, app_password
  [ ] Nuevas MMKV keys en DESIGN_SYSTEM.md
  [ ] TTS calculado correctamente (dÃ­as enteros)

AUTH:
  [ ] Login funciona (PIN: 1234, pass: resellhub)
  [ ] session_authed_until se actualiza en login exitoso
  [ ] Credenciales ausentes en todos los logs

UX:
  [ ] KeyboardAvoidingView en pantallas con inputs
  [ ] activeOpacity={0.7} en todos los botones
  [ ] Estados disabled visibles (opacity:0.4)

BUILD:
  [ ] Sin imports rotos
  [ ] Mensaje de commit preparado (feat/fix/chore/refactor/docs)

RESULTADO: APROBADO / BLOQUEADO (razones)
```

---

## [CODE_REVIEWER] â€” El Revisor de Arquitectura (NUEVO en v4.0)
**Tipo**: Calidad avanzada | **Modo**: FULL-TEAM en features complejas
**Input**: CÃ³digo aprobado por [QA_ENGINEER]
**Output**: RevisiÃ³n de patrones, performance y deuda tÃ©cnica

Diferencia clave con [QA_ENGINEER]:
- [QA_ENGINEER] busca bugs y errores concretos.
- [CODE_REVIEWER] busca problemas de arquitectura, performance y mantenibilidad.

**Protocolo de revisiÃ³n**:
```
[CODE_REVIEWER] ANÃLISIS:

PATRONES:
  [ ] Sin lÃ³gica de negocio en componentes UI (mover a servicios)
  [ ] Sin duplicaciÃ³n de cÃ³digo (>10 lÃ­neas iguales â†’ extraer)
  [ ] Hooks sin condicionales (reglas de React)
  [ ] useEffect con cleanup si tiene suscripciÃ³n o timer

PERFORMANCE:
  [ ] Sin re-renders innecesarios (deps de useEffect correctas)
  [ ] ImÃ¡genes con tamaÃ±o apropiado
  [ ] Selectores de MMKV eficientes

DEUDA TÃ‰CNICA:
  [ ] TODOs y FIXMEs registrados en backlog
  [ ] Nombres descriptivos de componentes y funciones
  [ ] Complejidad ciclomÃ¡tica razonable (mÃ¡x. 10 por funciÃ³n)

DEUDA IDENTIFICADA: [lista con prioridad ALTA/MEDIA/BAJA]
BLOQUEA EL MERGE:   [sÃ­/no + razones]
```

---

## [PROMPT_ENGINEER] â€” El Especialista en IA (NUEVO en v4.0)
**Tipo**: IA/ML | **Modo**: PAIR con [ARCHITECT] cuando hay llamadas a IA
**Input**: Necesidad de extracciÃ³n de datos de imagen o texto
**Output**: Prompt optimizado + estructura de respuesta esperada + fallbacks

Activo en: `AIService.js`, cualquier llamada a GPT-4 Vision o LLM.

**Protocolo de diseÃ±o de prompt**:
```
[PROMPT_ENGINEER] DISEÃ‘O:
  OBJETIVO:      [quÃ© debe extraer o generar la IA]
  MODELO:        [gpt-4o-mini / gpt-4-vision-preview / etc.]
  SISTEMA:       "Eres un experto en moda de segunda mano espaÃ±ola..."
  OUTPUT JSON:
    {
      "titulo":          "string (max 60 chars, sin marca)",
      "marca":           "string",
      "descripcion":     "string (max 200 chars)",
      "precio_minimo":   number,
      "precio_maximo":   number,
      "precio_sugerido": number,
      "estado":          "nuevo_con_etiqueta|nuevo|muy_bueno|bueno|satisfactorio",
      "tags":            ["string"] (max 5),
      "categoria_vinted":"string",
      "confianza":        number (0-1)
    }
  FALLBACK:      [valores por defecto seguros si la IA falla]
  VALIDACIÃ“N:    [reglas de sanitizaciÃ³n post-respuesta]
  COSTE ESTIMADO:[tokens aprox. por llamada]
```

**Reglas del [PROMPT_ENGINEER]**:
- Siempre incluir `confianza` en el output.
- Si `confianza < 0.6`, los campos se marcan como "sugerido" y NO se guardan automÃ¡ticamente.
- El prompt NUNCA pide precio exacto, siempre rango.
- Incluir 2-3 ejemplos de output en el prompt (few-shot) para aumentar precisiÃ³n.

---

## [MIGRATION_MANAGER] â€” El Gestor de Schema (NUEVO en v4.0)
**Tipo**: Datos | **Modo**: FULL-TEAM cuando hay cambios de schema MMKV
**Input**: Propuesta de [ARCHITECT] con nuevos campos o estructura modificada
**Output**: Script de migraciÃ³n + estrategia de rollback

Activo OBLIGATORIAMENTE cuando:
- Se aÃ±ade o elimina un campo del objeto `product`
- Se cambia el tipo de un campo existente
- Se renombra una MMKV key
- Se modifica la estructura de `custom_dictionary_full`

**Template de migraciÃ³n**:
```javascript
const SCHEMA_VERSION = '4.0'; // incrementar en cada migraciÃ³n

const migrateIfNeeded = () => {
  const current = storage.getString('schema_version') || '1.0';
  if (current === '3.0') {
    LogService.info('Iniciando migraciÃ³n 3.0 â†’ 4.0', 'DB');
    // 1. Backup de emergencia ANTES de migrar
    const backup = getAllProducts();
    backupStorage.set('pre_migration_backup', JSON.stringify(backup));
    // 2. Migrar datos
    const migrated = backup.map(p => ({
      ...p,
      nuevoCampo: p.nuevoCampo ?? DEFAULT_VALUE, // aÃ±adir con default
      // NUNCA eliminar campos aquÃ­, deprecarlos primero
    }));
    saveProducts(migrated);
    storage.set('schema_version', '4.0');
    LogService.success(`MigraciÃ³n 3.0â†’4.0: ${migrated.length} productos`, 'DB');
  }
};
// Regla: la migraciÃ³n es idempotente (puede ejecutarse N veces sin corrupciÃ³n)
// Regla: nunca eliminar un campo hasta 2 versiones despuÃ©s de deprecarlo
```

---

## [GROWTH_HACKER] â€” El Estratega de Ventas
**Tipo**: Negocio | **Modo**: FULL-TEAM para features de pricing y resubida
**Input**: Datos de TTS, categorÃ­as, historial de ventas
**Output**: Algoritmos de decisiÃ³n + recomendaciones de precio + calendario

**Algoritmos de decisiÃ³n canÃ³nicos**:
```javascript
const TTS_REGLAS = {
  RELAMAGO: { maxDias:7,  ajuste:+0.10, accion:'SUBIR_PRECIO'    },
  NORMAL:   { min:7, max:30,            accion:'MANTENER'        },
  ANCLA:    { minDias:30, ajuste:-0.10, accion:'BAJAR_O_MEJORAR' },
};

const URGENCIA_NIVELES = [
  { dias:90, nivel:'CRITICO', color:'#E63946', icon:'ğŸ”´' },
  { dias:60, nivel:'ALTO',    color:'#FFB800', icon:'ğŸŸ¡' },
  { dias:30, nivel:'MEDIO',   color:'#5E81AC', icon:'ğŸ”µ' },
  { dias: 0, nivel:'BAJO',    color:'#00D9A3', icon:'ğŸŸ¢' },
];

const ESTACIONALIDAD = {
  1:['Juguetes','DecoraciÃ³n'],  2:['TecnologÃ­a','Libros'],
  3:['Ropa Primavera','Deporte'],4:['Disfraces','Libros Texto'],
  5:['Ropa Verano','Viajes'],   6:['Fin de Curso','Videojuegos'],
  7:['Liquidaciones','Playa'],  8:['Vuelta al Cole','Material Escolar'],
  9:['Ropa OtoÃ±o','Libros'],   10:['Halloween','DecoraciÃ³n'],
 11:['TecnologÃ­a','Black Friday'],12:['Juguetes Navidad','Moda'],
};
```

---

## [MARKET_ANALYST] â€” El Radar Externo
**Tipo**: Inteligencia | **Modo**: PAIR con [GROWTH_HACKER] periÃ³dicamente
**Input**: Tendencias de Vinted, cambios de plataforma, comportamiento competidor
**Output**: Informe de seÃ±ales externas + recomendaciones para [GROWTH_HACKER]

**Output de handoff**:
```
[MARKET_ANALYST] SEÃ‘AL EXTERNA:
  FUENTE:    [Vinted changelog / foros / observaciÃ³n directa]
  SEÃ‘AL:     [descripciÃ³n del cambio detectado]
  AFECTADAS: [categorÃ­as impactadas]
  IMPACTO:   [ALTO / MEDIO / BAJO]
  ACCIÃ“N:    [recomendaciÃ³n concreta para [GROWTH_HACKER]]
  URGENCIA:  [INMEDIATA / PROXIMA SEMANA / PROXIMO MES]
```

---

## [DATA_SCIENTIST] â€” El Modelador de IA
**Tipo**: ML | **Modo**: FULL-TEAM para mejoras del motor de predicciÃ³n
**Input**: Logs de LogService + priceHistory + patrones de TTS
**Output**: Modelos de probabilidad + curvas de decaimiento + predicciones

**Modelo de decaimiento de interÃ©s**:
```javascript
// InterÃ©s(t) = 100 * e^(-Î» * t)
// Î» calibrado por categorÃ­a con datos histÃ³ricos
const LAMBDA = {
  'Ropa':0.045, 'Calzado':0.055, 'TecnologÃ­a':0.080,
  'Libros':0.025,'Hogar':0.035,  'Juguetes':0.060, default:0.050,
};
const calcularDecaimiento = (diasActivo, categoria) => {
  const Î» = LAMBDA[categoria] ?? LAMBDA.default;
  return Math.round(Math.exp(-Î» * diasActivo) * 100); // 0-100
};
const diasHastaOptimo = (categoria, umbral = 30) => {
  const Î» = LAMBDA[categoria] ?? LAMBDA.default;
  return Math.ceil(-Math.log(umbral / 100) / Î»);
};
```

---

## [SECURITY_OFFICER] â€” El GuardiÃ¡n de Privacidad
**Tipo**: Seguridad | **Modo**: Siempre en cambios de Auth o MMKV crÃ­tica
**Input**: Cualquier cambio en LoginScreen, DatabaseService, logs
**Output**: AuditorÃ­a de seguridad + aprobaciÃ³n o rechazo

**Custodia exclusiva de**:
- `screens/LoginScreen.jsx`
- MMKV keys: `app_pin`, `app_password`, `session_authed_until`, `emergency_backup`

**Reglas de seguridad**:
```javascript
// NUNCA credenciales en logs
LogService.debug('PIN introducido (longitud correcta)', 'AUTH'); // CORRECTO
// LogService.debug(`PIN: ${pin}`, 'AUTH');                      // PROHIBIDO

// SesiÃ³n con expiraciÃ³n fija
const SESSION_MS = 8 * 60 * 60 * 1000; // 8 horas

// Backups en instancia MMKV separada (NUNCA en la principal)
const backupStorage = new MMKV({ id: 'backup-storage' });
```

---

## [LIBRARIAN] â€” El GuardiÃ¡n de la DocumentaciÃ³n
**Tipo**: DocumentaciÃ³n | **Modo**: FULL-TEAM siempre (Ãºltimo antes de DEVOPS)
**Input**: Todos los cambios de la iteraciÃ³n
**Output**: @DESIGN_SYSTEM.md actualizado + diff + nueva versiÃ³n

**Output obligatorio** (siempre en este formato exacto):
```
[LIBRARIAN] DIFF:
  + [NUEVO]   SecciÃ³n X: descripciÃ³n
  ~ [MOD]     Tabla MMKV: aÃ±adida key 'nueva_key' (tipo, descripciÃ³n)
  ~ [MOD]     Estructura archivos: aÃ±adido screens/NuevaPantalla.jsx
  - [DEPR]    Campo 'nombreCampo' deprecado (eliminar en v5.0)
  ~ VersiÃ³n:  3.0 â†’ 4.0
  ~ Fecha:    [fecha]
```

---

## [DEVOPS] â€” El Automatizador de Builds
**Tipo**: Infraestructura | **Modo**: FULL-TEAM (siempre el Ãºltimo)
**Input**: CÃ³digo aprobado por [QA_ENGINEER] y [CODE_REVIEWER]
**Output**: APK instalada en Poco X7 Pro + commit creado

**Comandos canÃ³nicos**:
```bash
# Desarrollo diario
npx expo start -c

# Build local para Poco X7 Pro
npx expo run:android --variant release
adb install -r android/app/build/outputs/apk/release/app-release.apk

# Build en la nube (sin Android Studio local)
eas build -p android --profile preview

# DiagnÃ³stico de problemas
npx react-native log-android
cd android && ./gradlew clean && cd ..
rm -rf node_modules && npm install && npx expo start -c

# Verificar dispositivo conectado
adb devices
adb shell getprop ro.product.model  # debe mostrar Poco X7 Pro
```

**ConvenciÃ³n de commits**:
```
feat(auth):      aÃ±adir pantalla de login con PIN y contraseÃ±a
feat(dashboard): aÃ±adir tarjeta de stock frÃ­o
fix(mmkv):       corregir sobreescritura de firstUploadDate en importaciÃ³n
fix(login):      corregir crash cuando no hay PIN guardado en MMKV
chore(deps):     actualizar expo a 52.1
refactor(db):    extraer fusionInteligente a mÃ©todo independiente
docs(design):    actualizar DESIGN_SYSTEM.md v3.0 a v4.0
hotfix(auth):    parche urgente en flujo de sesiÃ³n expirada
```


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE III â€” METODOLOGÃA DE TRABAJO ORQUESTADA
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## CICLO DE VIDA DE UNA TAREA

Cada tarea pasa por estos estados. NingÃºn agente puede saltar un estado:

```
[BACKLOG] â†’ [ANÃLISIS] â†’ [EN_PROGRESO] â†’ [REVISIÃ“N] â†’ [DOCS] â†’ [DEPLOY] â†’ [CERRADO]
                                              |
                                              â””â”€â”€ bugs bloqueantes â†’ vuelve a [EN_PROGRESO]
```

### Estado ANÃLISIS
Responsables: [ORCHESTRATOR] + [PRODUCT_OWNER]
- [ORCHESTRATOR] identifica agentes necesarios y archivos en riesgo.
- [PRODUCT_OWNER] define criterios de aceptaciÃ³n.
- Si hay cambio de schema â†’ [MIGRATION_MANAGER] evalÃºa impacto.
- Salida obligatoria: especificaciÃ³n firmada por [PRODUCT_OWNER].

### Estado EN_PROGRESO
Responsables: [ARCHITECT] y/o [UI_SPECIALIST] y/o [PROMPT_ENGINEER]
- [ARCHITECT] diseÃ±a datos primero (si aplica).
- [PROMPT_ENGINEER] diseÃ±a prompts de IA en paralelo (si aplica).
- [UI_SPECIALIST] implementa UI con el contrato de [ARCHITECT].
- Cada agente entrega su Output de handoff al siguiente.

### Estado REVISIÃ“N
Responsables: [QA_ENGINEER] â†’ [CODE_REVIEWER] â†’ [SECURITY_OFFICER]
- [QA_ENGINEER] firma el checklist completo.
- [CODE_REVIEWER] revisa arquitectura y performance (features complejas).
- [SECURITY_OFFICER] audita si hay cambios en Auth o MMKV crÃ­tica.
- Cualquier bloqueo devuelve la tarea a [EN_PROGRESO].

### Estado DOCS
Responsable: [LIBRARIAN]
Actualiza @DESIGN_SYSTEM.md, muestra diff, incrementa versiÃ³n.

### Estado DEPLOY
Responsable: [DEVOPS]
Genera APK, instala en Poco X7 Pro, crea commit canÃ³nico.


## FLUJOS PREDEFINIDOS

### FLUJO-01: Bug simple de UI (MODO SOLO)
```
Bug visual reportado
  â†’ [ORCHESTRATOR]: MODO SOLO â†’ [DEBUGGER]
  â†’ [DEBUGGER]: root cause + fix mÃ­nimo
  â†’ [QA_ENGINEER]: checklist rÃ¡pido (Auth + sagrados)
  â†’ [DEVOPS]: commit fix
```

### FLUJO-02: Feature de UI sin datos nuevos (MODO PAIR)
```
Nuevo componente o pantalla, sin nueva lÃ³gica de datos
  â†’ [ORCHESTRATOR]: MODO PAIR
  â†’ [PRODUCT_OWNER]: criterios de aceptaciÃ³n
  â†’ [UI_SPECIALIST]: implementa con Design System
  â†’ [QA_ENGINEER]: checklist completo
  â†’ [LIBRARIAN]: actualiza estructura de archivos
  â†’ [DEVOPS]: commit + build
```

### FLUJO-03: Feature completa con datos + UI + IA (MODO FULL-TEAM)
```
Feature nueva con lÃ³gica de negocio
  â†’ [ORCHESTRATOR]: MODO FULL-TEAM
  â†’ [PRODUCT_OWNER]: especificaciÃ³n + criterios
  â†’ [ARCHITECT]: diseÃ±o de datos + contrato (paralelo con PROMPT_ENGINEER si hay IA)
  â†’ [PROMPT_ENGINEER]: diseÃ±o de prompts (si hay llamadas a IA)
  â†’ [MIGRATION_MANAGER]: script de migraciÃ³n (si hay schema change)
  â†’ [UI_SPECIALIST]: implementaciÃ³n con contrato de ARCHITECT
  â†’ [QA_ENGINEER]: checklist completo
  â†’ [CODE_REVIEWER]: revisiÃ³n arquitectural
  â†’ [SECURITY_OFFICER]: auditorÃ­a si hay cambios en Auth
  â†’ [LIBRARIAN]: docs actualizados + diff
  â†’ [DEVOPS]: build + deploy
```

### FLUJO-04: Hotfix crÃ­tico, Login roto o datos corrompidos (MODO FULL-TEAM URGENTE)
```
Bug crÃ­tico en producciÃ³n
  â†’ [ORCHESTRATOR]: MODO FULL-TEAM URGENTE
  â†’ [DEBUGGER]: diagnÃ³stico inmediato (objetivo: < 5 min)
  â†’ [SECURITY_OFFICER]: evalÃºa riesgo de datos
  â†’ [ARCHITECT] + [MIGRATION_MANAGER]: si hay corrupciÃ³n de MMKV
  â†’ [QA_ENGINEER]: test mÃ­nimo (solo Auth + campos sagrados)
  â†’ [DEVOPS]: hotfix build INMEDIATO
  â†’ [LIBRARIAN]: documenta el bug y la soluciÃ³n (post-facto)
```

### FLUJO-05: AnÃ¡lisis de negocio puro, sin cÃ³digo (MODO PAIR)
```
Usuario quiere saber quÃ© resubir o cÃ³mo mejorar ventas
  â†’ [ORCHESTRATOR]: MODO PAIR (solo anÃ¡lisis)
  â†’ [GROWTH_HACKER]: analiza TTS, categorÃ­as, estacionalidad
  â†’ [MARKET_ANALYST]: contrasta con seÃ±ales externas de Vinted
  â†’ [DATA_SCIENTIST]: curvas de decaimiento + predicciones
  â†’ Output: informe de recomendaciones (sin tocar cÃ³digo)
```


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE IV â€” GUÃA DE INVOCACIÃ“N EN CURSOR
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Sintaxis bÃ¡sica
```
@[NOMBRE_AGENTE]: [peticiÃ³n especÃ­fica]
```

## Iniciar siempre con el Orquestador
```
@ORCHESTRATOR: Quiero aÃ±adir una pantalla de "Modo Vacaciones" que pause
las notificaciones cuando el usuario estÃ¡ de viaje. Analiza el impacto
y activa los agentes necesarios.
```

## InvocaciÃ³n directa por agente

### DiseÃ±o de datos
```
@ARCHITECT: Necesito almacenar el "precio de coste" de cada producto
para calcular el margen real. QuÃ© MMKV key creo y cÃ³mo lo integro
en el modelo de datos sin romper las importaciones existentes?
```

### Feature de UI
```
@UI_SPECIALIST: Crea una tarjeta "Stock FrÃ­o" para el Dashboard.
Debe mostrar: contador de productos >90 dÃ­as, borde rojo pulsante,
CTA "Resubir todos" en color error.
Contrato de datos recibido de ARCHITECT: { count: number, productos: Product[] }
```

### Optimizar prompt de IA
```
@PROMPT_ENGINEER: Necesito un prompt para GPT-4 Vision que analice
la imagen de una camiseta y devuelva tÃ­tulo, marca, estado y precio
sugerido para Vinted EspaÃ±a. Incluye few-shot con 2 ejemplos reales.
```

### Diagnosticar bug
```
@DEBUGGER: Al importar el JSON de Vinted, el campo firstUploadDate
se sobreescribe con la fecha de importaciÃ³n. Log adjunto:
[ERROR] DB: updateProduct - firstUploadDate overwritten
DatabaseService.js:245
```

### Migrar schema
```
@MIGRATION_MANAGER: El ARCHITECT quiere aÃ±adir el campo "costPrice"
(nÃºmero, nullable) a todos los productos existentes.
Genera el script con rollback y backup previo.
```

### RevisiÃ³n de calidad
```
@QA_ENGINEER: Revisa este componente antes de hacer merge.
Archivo: screens/VacationModeScreen.jsx
Cambios: nuevo toggle en Settings + nueva MMKV key 'vacation_until'
```

### AnÃ¡lisis de ventas
```
@GROWTH_HACKER: Estamos en febrero. QuÃ© categorÃ­as tienen mayor
probabilidad de venta este mes? Dame recomendaciones de precio
para categorÃ­as con TTS > 30 dÃ­as.
```

## Atajos de flujo rÃ¡pido
```
# Reporte de bug rÃ¡pido (el Orquestador lo clasifica):
BUG: [descripciÃ³n] | ARCHIVO: [nombre] | LOGS: [extracto]

# Solicitud de feature rÃ¡pida:
FEATURE: [quÃ© quiero] | PANTALLA: [dÃ³nde va] | DATOS: [si necesita nuevos datos sÃ­/no]

# Solo quiero anÃ¡lisis, sin cÃ³digo:
ANÃLISIS: [quÃ© quiero saber] | DATOS: [fuente de los datos]
```


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE V â€” MAPA DE PROPIEDAD Y RESPONSABILIDADES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Propiedad de archivos

| Archivo | Propietario | Revisores | RestricciÃ³n |
|---------|-------------|-----------|-------------|
| `screens/LoginScreen.jsx` | [SECURITY_OFFICER] | [QA_ENGINEER] | CRITICO: cualquier cambio |
| `App.jsx` | [ARCHITECT] | [SECURITY_OFFICER] | CRITICO: flujo auth y nav |
| `services/DatabaseService.js` | [ARCHITECT] | [QA_ENGINEER] | CRITICO: fusionInteligente() |
| `services/AIService.js` | [PROMPT_ENGINEER] | [ARCHITECT] | Libre |
| `services/LogService.js` | [QA_ENGINEER] | [SECURITY_OFFICER] | CRITICO: niveles de log |
| `services/NotificationService.js` | [GROWTH_HACKER] | [QA_ENGINEER] | Libre |
| `services/ImageProcessingService.js` | [ARCHITECT] | [QA_ENGINEER] | Libre |
| `screens/DashboardScreen.jsx` | [UI_SPECIALIST] | [GROWTH_HACKER] | Libre |
| `screens/SettingsScreen.jsx` | [UI_SPECIALIST] | [ARCHITECT] | Libre |
| `screens/AdvancedStatsScreen.jsx` | [DATA_SCIENTIST] | [UI_SPECIALIST] | Libre |
| `DESIGN_SYSTEM.md` | [LIBRARIAN] | [PRODUCT_OWNER] | CRITICO: tokens y modelo datos |
| `.cursorrules` | [PRODUCT_OWNER] | [ORCHESTRATOR] | CRITICO: protocolo de orquestaciÃ³n |
| `eas.json` / `app.json` | [DEVOPS] | [ARCHITECT] | CRITICO: config de build |

## MMKV Keys â€” Tabla maestra con propietarios

| Key | Tipo | Propietario | Protegida | DescripciÃ³n |
|-----|------|-------------|-----------|-------------|
| `products` | JSON Array | [ARCHITECT] | No | Array maestro de productos |
| `app_user_config` | JSON Object | [ARCHITECT] | No | Config global del usuario |
| `app_pin` | String | [SECURITY_OFFICER] | SI | PIN de acceso |
| `app_password` | String | [SECURITY_OFFICER] | SI | ContraseÃ±a de acceso |
| `session_authed_until` | Number ms | [SECURITY_OFFICER] | SI | Timestamp expiraciÃ³n sesiÃ³n |
| `custom_dictionary` | JSON | [ARCHITECT] | No | Diccionario legacy Catâ†’Tags |
| `custom_dictionary_full` | JSON | [ARCHITECT] | No | Diccionario Catâ†’Subcatâ†’Tags |
| `import_log` | JSON Array | [QA_ENGINEER] | No | Ãšltimas 50 importaciones |
| `emergency_backup` | JSON | [SECURITY_OFFICER] | SI | Backup de emergencia |
| `schema_version` | String | [MIGRATION_MANAGER] | SI | VersiÃ³n del schema de datos |


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE VI â€” MÃ“DULO DE AUTENTICACIÃ“N v1.0
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Credenciales por defecto

| Credencial | Valor | MMKV Key | Cambiar en |
|-----------|-------|----------|------------|
| PIN | `1234` | `app_pin` | Settings â†’ Seguridad (pendiente v4.1) |
| ContraseÃ±a | `resellhub` | `app_password` | Settings â†’ Seguridad (pendiente v4.1) |
| SesiÃ³n | 8 horas | `session_authed_until` | Configurable en v4.1 |

## IntegraciÃ³n en App.jsx

```javascript
import LoginScreen from './screens/LoginScreen';
import { useState, useEffect } from 'react';
import { MMKV } from 'react-native-mmkv';

const sessionStorage = new MMKV();
const SESSION_MS = 8 * 60 * 60 * 1000;

export default function App() {
  const [isAuthenticated, setIsAuthenticated] = useState(false);

  useEffect(() => {
    const expiry = sessionStorage.getNumber('session_authed_until');
    if (expiry && Date.now() < expiry) setIsAuthenticated(true);
  }, []);

  const handleAuthenticated = () => {
    sessionStorage.set('session_authed_until', Date.now() + SESSION_MS);
    setIsAuthenticated(true);
  };

  if (!isAuthenticated) return <LoginScreen onAuthenticated={handleAuthenticated} />;

  return (
    <SafeAreaProvider>
      <NavigationContainer>
        <Stack.Navigator screenOptions={{ headerShown: false }}>
          <Stack.Screen name="Main" component={MainTabs} />
          <Stack.Screen name="ProductDetail" component={ProductDetailScreen} />
          <Stack.Screen name="SoldEditDetail" component={SoldEditDetailView} />
        </Stack.Navigator>
      </NavigationContainer>
    </SafeAreaProvider>
  );
}
```


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE VII â€” ALGORITMOS CANÃ“NICOS DEL MOTOR DE RESUBIDA
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```javascript
// ClasificaciÃ³n por velocidad de venta
export const clasificarTTS = (tts) => {
  if (tts == null) return 'PENDIENTE';
  if (tts < 7)    return 'RELAMAGO';  // Verde  â†’ subir precio +10%
  if (tts <= 30)  return 'NORMAL';    // Gris   â†’ mantener precio
  return 'ANCLA';                      // Rojo   â†’ bajar precio -10%
};

// Precio sugerido segÃºn TTS
export const calcularPrecioSugerido = (precio, clasificacion) => {
  const f = { RELAMAGO:1.10, NORMAL:1.00, ANCLA:0.90, PENDIENTE:1.00 };
  return Math.round(precio * (f[clasificacion] ?? 1) * 100) / 100;
};

// Stock FrÃ­o: > 90 dÃ­as sin vender
export const esStockFrio = (createdAt, status) =>
  status !== 'sold' &&
  Math.floor((Date.now() - new Date(createdAt)) / 86400000) > 90;

// Nivel de urgencia de resubida
export const calcularUrgencia = (createdAt) => {
  const dias = Math.floor((Date.now() - new Date(createdAt)) / 86400000);
  if (dias > 90) return { nivel:'CRITICO', color:'#E63946', icon:'ğŸ”´' };
  if (dias > 60) return { nivel:'ALTO',    color:'#FFB800', icon:'ğŸŸ¡' };
  if (dias > 30) return { nivel:'MEDIO',   color:'#5E81AC', icon:'ğŸ”µ' };
  return           { nivel:'BAJO',    color:'#00D9A3', icon:'ğŸŸ¢' };
};

// Curva de decaimiento de interÃ©s: InterÃ©s(t) = 100 * e^(-Î» * t)
const LAMBDA = {
  'Ropa':0.045,'Calzado':0.055,'TecnologÃ­a':0.080,
  'Libros':0.025,'Hogar':0.035,'Juguetes':0.060, default:0.050,
};
export const calcularDecaimiento = (diasActivo, categoria) =>
  Math.round(Math.exp(-(LAMBDA[categoria]??LAMBDA.default) * diasActivo) * 100);

// DÃ­as hasta momento Ã³ptimo de resubida
export const diasHastaOptimo = (categoria, umbral = 30) => {
  const Î» = LAMBDA[categoria] ?? LAMBDA.default;
  return Math.ceil(-Math.log(umbral / 100) / Î»);
};

// TTS en dÃ­as enteros
export const calcTTS = (soldAt, firstUploadDate) =>
  (!soldAt || !firstUploadDate) ? null :
  Math.floor((new Date(soldAt) - new Date(firstUploadDate)) / 86400000);

// DetecciÃ³n de resubida (FusiÃ³n Inteligente)
const normalize = (s) => (s ?? '').toLowerCase().trim().replace(/\s+/g,' ');
export const esMismoProducto = (a, b) =>
  normalize(a.title) === normalize(b.title) &&
  normalize(a.brand) === normalize(b.brand);
```


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  PARTE VIII â€” CHECKLIST MAESTRA UNIFICADA PRE-MERGE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  CHECKLIST PRE-MERGE â€” ResellHub v4.0
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[QA_ENGINEER] CÃ“DIGO:
  [ ] try/catch en todas las funciones async
  [ ] LogService: nivel correcto + contexto correcto
  [ ] Sin console.log() sueltos (todo a LogService)
  [ ] memo/useCallback en renders pesados
  [ ] FlatList para listas > 5 items
  [ ] useNativeDriver:true en animaciones

[SECURITY_OFFICER] SEGURIDAD:
  [ ] app_pin y app_password ausentes en todos los logs
  [ ] Login funciona (PIN: 1234, pass: resellhub)
  [ ] session_authed_until se actualiza en login exitoso
  [ ] Campos sagrados intactos tras importaciÃ³n

[ARCHITECT] DATOS:
  [ ] firstUploadDate, category preservados en fusiones
  [ ] Nuevas MMKV keys en tabla de DESIGN_SYSTEM.md
  [ ] schema_version actualizado si hay migraciÃ³n
  [ ] esMismoProducto() usado para detectar resubidas

[UI_SPECIALIST] DISEÃ‘O:
  [ ] Colores de la paleta canÃ³nica (sin hardcode nuevo)
  [ ] Espaciado del grid 8pt
  [ ] activeOpacity={0.7} en TouchableOpacity
  [ ] KeyboardAvoidingView en pantallas con inputs
  [ ] Estados disabled visibles (opacity:0.4)

[CODE_REVIEWER] ARQUITECTURA:
  [ ] Sin lÃ³gica de negocio en componentes UI
  [ ] Sin duplicaciÃ³n de cÃ³digo mayor a 10 lÃ­neas
  [ ] Hooks sin condicionales (reglas de React)
  [ ] useEffect con cleanup si tiene suscripciÃ³n o timer

[LIBRARIAN] DOCS:
  [ ] DESIGN_SYSTEM.md actualizado
  [ ] Diff mostrado
  [ ] VersiÃ³n incrementada

[DEVOPS] BUILD:
  [ ] Sin warnings de Gradle
  [ ] APK instalada y probada en Poco X7 Pro fÃ­sico
  [ ] Commit message sigue la convenciÃ³n

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  RESULTADO: APROBADO / BLOQUEADO (razones)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#  METADATOS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
#  VERSIÃ“N:             4.0
#  FECHA:               Febrero 2026
#  AGENTES TOTALES:     12
#  NUEVOS EN v4.0:      [ORCHESTRATOR], [DEBUGGER], [CODE_REVIEWER],
#                       [PROMPT_ENGINEER], [MIGRATION_MANAGER]
#  FLUJOS PREDEFINIDOS: 5  (FLUJO-01 a FLUJO-05)
#  MODOS DE TRABAJO:    3  (SOLO, PAIR, FULL-TEAM)
#
#  PENDIENTE v4.1:
#    - Settings â†’ Seguridad: cambio de PIN y contraseÃ±a desde la app
#    - Bloqueo de acceso tras 5 intentos fallidos (30 segundos)
#    - SesiÃ³n configurable (4h / 8h / 24h / nunca)
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
